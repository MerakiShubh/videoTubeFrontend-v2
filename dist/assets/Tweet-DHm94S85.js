import{aA as b,ah as d,ai as m,aJ as v,aK as C,aL as S,aM as k,aN as P,a as p,r as o,j as s,E as q,N as A,aO as E,Q as D}from"./index-QFptoyZp.js";const _=e=>b({queryKey:["tweets"],queryFn:({pageParam:a=1})=>k({pageParam:a,authenticated:e}),getNextPageParam:a=>{if(a.hasNextPage)return a.nextPage},staleTime:1e3*60*5,retry:2}),M=e=>b({queryKey:["tweets",e],queryFn:({pageParam:a=1})=>e==null?Promise.resolve({docs:[],hasNextPage:!1}):P({pageParam:a,channelId:e}),getNextPageParam:a=>{if(a.hasNextPage)return a.nextPage},staleTime:1e3*60*5,retry:2,enabled:!!e}),L=()=>{const e=d();return m({mutationFn:({tweet:a})=>v({content:a}),onSuccess:()=>{e.invalidateQueries({queryKey:["tweets"]})}})},K=()=>{const e=d();return m({mutationFn:({tweetId:a,tweet:r})=>C(a,{content:r}),onSuccess:()=>{e.invalidateQueries({queryKey:["tweets"]})}})},Q=()=>{const e=d();return m({mutationFn:a=>S(a),onSuccess:()=>{e.invalidateQueries({queryKey:["tweets"]})}})};function J(){const e=p(i=>i.auth.authStatus),[a,r]=o.useState(!1),[l,n]=o.useState(""),{mutateAsync:t,isPending:x}=L(),c=async()=>{if(!e)return r(!0);await t({tweet:l}),n("")};return a?s.jsx(q,{loginTo:"write Tweet",onClose:()=>r(!1)}):s.jsxs("div",{className:"w-full mt-3 ",children:[s.jsx("textarea",{className:"w-full bg-transparent p-2 border rounded-lg border-slate-300",value:l,onChange:i=>n(i.target.value)}),s.jsx("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:c,children:"Send"})]})}function O({tweet:e,isOwner:a}){var f,g,h,y;const r=p(u=>u.auth.authStatus),[l,n]=o.useState(!1),[t,x]=o.useState(e==null?void 0:e.content),{mutateAsync:c}=Q(),i=async()=>{await c(e==null?void 0:e._id)},j=u=>{x(u.target.value)},{mutateAsync:N}=K(),T=async()=>{if(t.trim()===(e==null?void 0:e.content.trim())){n(!1);return}await N({tweetId:e._id,tweet:t})&&n(!1),console.log("edit")};return s.jsxs("div",{className:"py-2 flex h-3/12 justify-between border-b border-gray-700",children:[s.jsxs("div",{className:"flex gap-3  py-4 last:border-b-transparent",children:[s.jsx("div",{className:"h-14 w-14 shrink-0",children:s.jsx("img",{src:(g=(f=e==null?void 0:e.ownerDetails)==null?void 0:f.avatar)==null?void 0:g.url,alt:(h=e==null?void 0:e.ownerDetails)==null?void 0:h.username,className:"h-full w-full rounded-full object-cover"})}),s.jsxs("div",{className:"w-full",children:[s.jsxs("h4",{className:"mb-1 flex items-center gap-x-2",children:[s.jsx("span",{className:"font-semibold",children:(y=e==null?void 0:e.ownerDetails)==null?void 0:y.username}),s.jsx("span",{className:"inline-block text-sm text-gray-400",children:A(e==null?void 0:e.createdAt)})]}),l?s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"text",className:"w-full mt-3 p-2 text-gray-200 bg-gray-800 border border-gray-800 rounded-md dark:border-gray-700  focus:border-blue-500 focus:ring-opacity-40 dark:focus:ring-opacity-40 focus:ring-blue-300 dark:focus:ring-blue-400 focus:ring dark:bg-gray-800 focus:outline-none",value:t,onChange:j}),s.jsx("button",{onClick:()=>n(!1),className:"mt-3 px-4 py-2 text-sm text-white bg-blue-500 rounded-md",children:"Cancel"}),s.jsx("button",{onClick:()=>T(),className:"mt-3 px-4 py-2 text-sm text-white bg-blue-500 rounded-md",children:"Save"})]}):s.jsx("p",{className:"mb-2",children:e==null?void 0:e.content})]})]}),s.jsxs("div",{className:"sm:w-[4%] w-[10%] mr-5  flex flex-col gap-3 h-full items-center justify-center",children:[r&&a&&s.jsx("div",{className:"w-full flex items-center mr-6",children:s.jsx(E,{handleDelete:i,handleEdit:()=>n(!0)})}),s.jsx("div",{className:"w-full",children:s.jsx(D,{id:e==null?void 0:e._id,isLiked:e==null?void 0:e.isLiked,likesCount:e==null?void 0:e.likesCount,type:"tweets"})})]})]})}export{J as T,O as a,_ as b,M as u};
